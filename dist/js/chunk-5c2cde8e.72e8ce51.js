(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5c2cde8e"],{"0ceb":function(e,t,n){"use strict";var r=n("a9c3"),s=n.n(r);s.a},"34d9":function(e,t,n){"use strict";var r=n("8216"),s=n("be57");e.exports=r("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),s)},"4a60":function(e,t,n){"use strict";var r=n("ce14"),s=n.n(r);s.a},9941:function(e,t,n){"use strict";var r=n("c7dd"),s=n.n(r);s.a},a9c3:function(e,t,n){},c7dd:function(e,t,n){},cde5:function(e,t,n){"use strict";n.r(t);var r,s,i=function(){var e=this,t=this,n=t.$createElement,r=t._self._c||n;return r("div",{staticClass:"app-container schedule-list"},[r("parameters-dialog",{attrs:{visible:t.isParametersVisible,param:t.scheduleForm.param},on:{confirm:t.onParametersConfirm,close:function(e){t.isParametersVisible=!1}}}),r("v-tour",{attrs:{name:"schedule-list",steps:t.tourSteps,callbacks:t.tourCallbacks,options:t.$utils.tour.getOptions(!0)}}),r("v-tour",{attrs:{name:"schedule-list-add",steps:t.tourAddSteps,callbacks:t.tourAddCallbacks,options:t.$utils.tour.getOptions(!0)}}),r("el-dialog",{attrs:{title:t.$t(t.dialogTitle),visible:t.dialogVisible,width:"640px","before-close":t.onDialogClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[r("el-form",{ref:"scheduleForm",staticClass:"add-form",attrs:{"label-width":"180px",model:t.scheduleForm,"inline-message":!0,"label-position":"right"}},[r("el-form-item",{attrs:{label:t.$t("Schedule Name"),prop:"name",required:""}},[r("el-input",{attrs:{id:"schedule-name",placeholder:t.$t("Schedule Name")},model:{value:t.scheduleForm.name,callback:function(e){t.$set(t.scheduleForm,"name",e)},expression:"scheduleForm.name"}})],1),r("el-form-item",{attrs:{label:t.$t("Run Type"),prop:"run_type",required:""}},[r("el-select",{attrs:{id:"run-type",placeholder:t.$t("Run Type")},model:{value:t.scheduleForm.run_type,callback:function(e){t.$set(t.scheduleForm,"run_type",e)},expression:"scheduleForm.run_type"}},[r("el-option",{attrs:{value:"all-nodes",label:t.$t("All Nodes")}}),r("el-option",{attrs:{value:"selected-nodes",label:t.$t("Selected Nodes")}}),r("el-option",{attrs:{value:"random",label:t.$t("Random")}})],1)],1),"selected-nodes"===t.scheduleForm.run_type?r("el-form-item",{attrs:{label:t.$t("Nodes"),prop:"node_ids",required:""}},[r("el-select",{attrs:{id:"node-ids",placeholder:t.$t("Nodes"),multiple:"",filterable:""},model:{value:t.scheduleForm.node_ids,callback:function(e){t.$set(t.scheduleForm,"node_ids",e)},expression:"scheduleForm.node_ids"}},t._l(t.nodeList,(function(e){return r("el-option",{key:e._id,attrs:{value:e._id,label:e.name,disabled:"offline"===e.status}})})),1)],1):t._e(),t.isDisabledSpiderSchedule?r("el-form-item",{attrs:{label:t.$t("Spider"),required:""}},[r("el-select",{attrs:{value:t.spiderId,placeholder:t.$t("Spider"),filterable:"",disabled:t.isDisabledSpiderSchedule}},t._l(t.allSpiderList,(function(e){return r("el-option",{key:e._id,attrs:{value:e._id,label:e.display_name+" ("+e.name+")",disabled:t.isDisabledSpider(e)}})})),1)],1):r("el-form-item",{attrs:{label:t.$t("Spider"),prop:"spider_id",required:""}},[r("el-select",{attrs:{id:"spider-id",placeholder:t.$t("Spider"),filterable:"",disabled:t.isDisabledSpiderSchedule},on:{change:t.onSpiderChange},model:{value:t.scheduleForm.spider_id,callback:function(e){t.$set(t.scheduleForm,"spider_id",e)},expression:"scheduleForm.spider_id"}},t._l(t.allSpiderList,(function(e){return r("el-option",{key:e._id,attrs:{value:e._id,label:e.display_name+" ("+e.name+")",disabled:t.isDisabledSpider(e)}})})),1)],1),t.spiderForm.is_scrapy?r("el-form-item",{attrs:{label:t.$t("Scrapy Spider"),prop:"scrapy_spider",required:"","inline-message":""}},[r("el-select",{attrs:{placeholder:t.$t("Scrapy Spider"),disabled:t.isLoading},model:{value:t.scheduleForm.scrapy_spider,callback:function(e){t.$set(t.scheduleForm,"scrapy_spider",e)},expression:"scheduleForm.scrapy_spider"}},t._l(t.spiderForm.spider_names,(function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1):t._e(),t.spiderForm.is_scrapy?r("el-form-item",{attrs:{label:t.$t("Scrapy Log Level"),prop:"scrapy_spider",required:"","inline-message":""}},[r("el-select",{attrs:{placeholder:t.$t("Scrapy Log Level")},model:{value:t.scheduleForm.scrapy_log_level,callback:function(e){t.$set(t.scheduleForm,"scrapy_log_level",e)},expression:"scheduleForm.scrapy_log_level"}},[r("el-option",{attrs:{value:"INFO",label:"INFO"}}),r("el-option",{attrs:{value:"DEBUG",label:"DEBUG"}}),r("el-option",{attrs:{value:"WARN",label:"WARN"}}),r("el-option",{attrs:{value:"ERROR",label:"ERROR"}})],1)],1):t._e(),r("el-form-item",{attrs:{label:t.$t("Cron"),prop:"cron",required:""}},[r("el-input",{ref:"cron",staticClass:"cron",staticStyle:{width:"calc(100% - 100px)"},attrs:{id:"cron",placeholder:""+t.$t("[minute] [hour] [day] [month] [day of week]")},model:{value:t.scheduleForm.cron,callback:function(e){t.$set(t.scheduleForm,"cron",e)},expression:"scheduleForm.cron"}}),r("el-button",{staticClass:"cron-edit",staticStyle:{width:"100px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:t.onShowCronDialog}},[t._v(" "+t._s(t.$t("Edit"))+" ")])],1),r("el-form-item",{attrs:{label:t.$t("Execute Command"),prop:"cmd"}},[r("el-input",{attrs:{id:"cmd",placeholder:t.$t("Execute Command"),disabled:""},model:{value:t.spiderForm.cmd,callback:function(e){t.$set(t.spiderForm,"cmd",e)},expression:"spiderForm.cmd"}})],1),"customized"===t.spiderForm.type?r("el-form-item",{attrs:{label:t.$t("Parameters"),prop:"param"}},[t.spiderForm.is_scrapy?[r("el-input",{staticClass:"param-input",attrs:{placeholder:t.$t("Parameters")},model:{value:t.scheduleForm.param,callback:function(e){t.$set(t.scheduleForm,"param",e)},expression:"scheduleForm.param"}}),r("el-button",{staticClass:"param-btn",attrs:{type:"primary",icon:"el-icon-edit"},on:{click:t.onOpenParameters}})]:[r("el-input",{attrs:{placeholder:t.$t("Parameters")},model:{value:t.scheduleForm.param,callback:function(e){t.$set(t.scheduleForm,"param",e)},expression:"scheduleForm.param"}})]],2):t._e(),r("el-form-item",{attrs:{label:t.$t("Schedule Description"),prop:"description"}},[r("el-input",{attrs:{id:"schedule-description",type:"textarea",placeholder:t.$t("Schedule Description")},model:{value:t.scheduleForm.description,callback:function(e){t.$set(t.scheduleForm,"description",e)},expression:"scheduleForm.description"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{size:"small"},on:{click:t.onCancel}},[t._v(t._s(t.$t("Cancel")))]),r("el-button",{attrs:{id:"btn-submit",size:"small",type:"primary",disabled:t.isLoading},on:{click:t.onAddSubmit}},[t._v(t._s(t.$t("Submit")))])],1)],1),r("el-dialog",{attrs:{title:t.$t("Tasks"),visible:t.isViewTasksDialogVisible,width:"calc(100% - 240px)","before-close":function(){return e.isViewTasksDialogVisible=!1}},on:{"update:visible":function(e){t.isViewTasksDialogVisible=e}}},[r("schedule-task-list",{ref:"schedule-task-list"})],1),r("el-dialog",{attrs:{title:"生成 Cron",visible:t.cronDialogVisible},on:{"update:visible":function(e){t.cronDialogVisible=e}}},[r("vue-cron-linux",{ref:"vue-cron-linux",attrs:{data:t.scheduleForm.cron,i18n:t.lang},on:{submit:t.onCronChange}}),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{size:"small"},on:{click:function(e){t.cronDialogVisible=!1}}},[t._v(t._s(t.$t("Cancel")))]),r("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.onCronDialogSubmit}},[t._v(t._s(t.$t("Confirm")))])],1)],1),r("crawl-confirm-dialog",{attrs:{visible:t.crawlConfirmDialogVisible,"spider-id":t.scheduleForm.spider_id},on:{close:function(){return t.crawlConfirmDialogVisible=!1},confirm:function(){return t.crawlConfirmDialogVisible=!1}}}),r("batch-add-schedule-dialog",{attrs:{visible:t.batchAddDialogVisible},on:{close:t.onBatchAddClose,confirm:t.onBatchAddConfirm}}),r("el-card",{staticClass:"schedule-list",staticStyle:{"border-radius":"0"}},[r("div",{staticClass:"filter"},[r("div",{staticClass:"right"},[r("el-button",{staticClass:"btn-add",attrs:{size:"small",type:"success",icon:"el-icon-document-copy"},on:{click:t.onBatchAdd}},[t._v(" "+t._s(t.$t("Batch Add"))+" ")]),r("el-button",{staticClass:"btn-add",attrs:{size:"small",type:"success",icon:"el-icon-plus"},on:{click:t.onAdd}},[t._v(" "+t._s(t.$t("Add Schedule"))+" ")]),t.selectedSchedules.length>0?r("el-button",{staticClass:"btn-enable",attrs:{size:"small",type:"primary",icon:"el-icon-check"},on:{click:t.onBatchEnable}},[t._v(" "+t._s(t.$t("Enable"))+" ")]):t._e(),t.selectedSchedules.length>0?r("el-button",{staticClass:"btn-disable",attrs:{size:"small",type:"info",icon:"el-icon-close"},on:{click:t.onBatchDisable}},[t._v(" "+t._s(t.$t("Disable"))+" ")]):t._e(),t.selectedSchedules.length>0?r("el-button",{staticClass:"btn-delete",attrs:{size:"small",type:"danger",icon:"el-icon-delete"},on:{click:t.onRemoveSelectedSchedules}},[t._v(" "+t._s(t.$t("Remove"))+" ")]):t._e()],1)]),r("el-table",{ref:"table",staticClass:"table",attrs:{data:t.filteredTableData,"header-cell-style":{background:"rgb(48, 65, 86)",color:"white"},border:"","row-key":"_id"},on:{"selection-change":t.onScheduleSelect}},[r("el-table-column",{attrs:{type:"selection",width:"45",align:"center","reserve-selection":""}}),t._l(t.columns,(function(e){return["status"===e.name?r("el-table-column",{key:e.name,attrs:{property:e.name,label:t.$t(e.label),sortable:e.sortable,align:e.align,width:e.width},scopedSlots:t._u([{key:"default",fn:function(n){return["error"===n.row[e.name]?r("el-tooltip",{attrs:{content:t.$t(n.row["message"]),placement:"top"}},[r("el-tag",{staticClass:"status-tag",attrs:{type:"danger"}},[t._v(" "+t._s(n.row[e.name]?t.$t(n.row[e.name]):t.$t("NA"))+" ")])],1):r("el-tag",{staticClass:"status-tag"},[t._v(" "+t._s(n.row[e.name]?t.$t(n.row[e.name]):t.$t("NA"))+" ")])]}}],null,!0)}):"run_type"===e.name?r("el-table-column",{key:e.name,attrs:{label:t.$t(e.label),width:e.width},scopedSlots:t._u([{key:"default",fn:function(e){return["all-nodes"===e.row.run_type?[t._v(t._s(t.$t("All Nodes")))]:"selected-nodes"===e.row.run_type?[t._v(t._s(t.$t("Selected Nodes")))]:"random"===e.row.run_type?[t._v(t._s(t.$t("Random")))]:t._e()]}}],null,!0)}):"node_names"===e.name?r("el-table-column",{key:e.name,attrs:{label:t.$t(e.label),width:e.width},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.nodes.map((function(e){return e.name})).join(", "))+" ")]}}],null,!0)}):"enable"===e.name?r("el-table-column",{key:e.name,attrs:{label:t.$t(e.label),width:e.width},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(n){return t.onEnabledChange(e.row)}},model:{value:e.row.enabled,callback:function(n){t.$set(e.row,"enabled",n)},expression:"scope.row.enabled"}})]}}],null,!0)}):r("el-table-column",{key:e.name,attrs:{property:e.name,label:t.$t(e.label),sortable:e.sortable,align:e.align,width:e.width},scopedSlots:t._u([{key:"default",fn:function(n){return[t._v(" "+t._s(n.row[e.name])+" ")]}}],null,!0)})]})),r("el-table-column",{staticClass:"actions",attrs:{label:t.$t("Action"),align:"left",width:"170",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-tooltip",{attrs:{content:t.$t("Edit"),placement:"top"}},[r("el-button",{attrs:{type:"warning",icon:"el-icon-edit",size:"mini"},on:{click:function(n){return t.onEdit(e.row)}}})],1),r("el-tooltip",{attrs:{content:t.$t("Remove"),placement:"top"}},[r("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(n){return t.onRemove(e.row)}}})],1),r("el-tooltip",{attrs:{content:t.$t("View Tasks"),placement:"top"}},[r("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:function(n){return t.onViewTasks(e.row)}}})],1),r("el-tooltip",{attrs:{content:t.$t("Run"),placement:"top"}},[r("el-button",{attrs:{type:"success",icon:"fa fa-bug",size:"mini"},on:{click:function(n){return t.onRun(e.row)}}})],1)]}}])})],2)],1)],1)},a=[],l=(n("2eeb"),n("1fb3"),n("6a61"),n("cf7f")),o=n("e793"),c=n("0c6d"),d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"change-crontab"}},[n("div",{staticClass:"cron-wrapper"},[n("label",[e._v(" "+e._s(e.$t("Cron Expression"))+": ")]),n("el-tag",{attrs:{type:"success",size:"small"}},[e._v(" "+e._s(e.cron)+" ")])],1),n("el-tabs",{attrs:{type:"border-card"}},[n("el-tab-pane",[n("span",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"el-icon-date"}),e._v(" "+e._s(e.text.Minutes.name))]),n("div",{staticClass:"tabBody"},[n("el-row",[n("el-radio",{attrs:{label:"1"},model:{value:e.minute.cronEvery,callback:function(t){e.$set(e.minute,"cronEvery",t)},expression:"minute.cronEvery"}},[e._v(e._s(e.text.Minutes.every))])],1),n("el-row",[n("el-radio",{attrs:{label:"2"},model:{value:e.minute.cronEvery,callback:function(t){e.$set(e.minute,"cronEvery",t)},expression:"minute.cronEvery"}},[e._v(e._s(e.text.Minutes.interval[0])+" "),n("el-input-number",{attrs:{size:"small",min:0,max:59},model:{value:e.minute.incrementIncrement,callback:function(t){e.$set(e.minute,"incrementIncrement",t)},expression:"minute.incrementIncrement"}}),e._v(" "+e._s(e.text.Minutes.interval[1])+" "),n("el-input-number",{attrs:{size:"small",min:0,max:59},model:{value:e.minute.incrementStart,callback:function(t){e.$set(e.minute,"incrementStart",t)},expression:"minute.incrementStart"}}),e._v(" "+e._s(e.text.Minutes.interval[2]||"")+" ")],1)],1),n("el-row",[n("el-radio",{staticClass:"long",attrs:{label:"3"},model:{value:e.minute.cronEvery,callback:function(t){e.$set(e.minute,"cronEvery",t)},expression:"minute.cronEvery"}},[e._v(e._s(e.text.Minutes.specific)+" "),n("el-select",{attrs:{size:"small",multiple:""},model:{value:e.minute.specificSpecific,callback:function(t){e.$set(e.minute,"specificSpecific",t)},expression:"minute.specificSpecific"}},e._l(60,(function(e){return n("el-option",{key:e,attrs:{value:(e-1).toString(),label:e-1}})})),1)],1)],1),n("el-row",[n("el-radio",{attrs:{label:"4"},model:{value:e.minute.cronEvery,callback:function(t){e.$set(e.minute,"cronEvery",t)},expression:"minute.cronEvery"}},[e._v(e._s(e.text.Minutes.cycle[0])+" "),n("el-input-number",{attrs:{size:"small",min:0,max:59},model:{value:e.minute.rangeStart,callback:function(t){e.$set(e.minute,"rangeStart",t)},expression:"minute.rangeStart"}}),e._v(" "+e._s(e.text.Minutes.cycle[1])+" "),n("el-input-number",{attrs:{size:"small",min:0,max:59},model:{value:e.minute.rangeEnd,callback:function(t){e.$set(e.minute,"rangeEnd",t)},expression:"minute.rangeEnd"}}),e._v(" "+e._s(e.text.Minutes.cycle[2])+" ")],1)],1)],1)]),n("el-tab-pane",[n("span",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"el-icon-date"}),e._v(" "+e._s(e.text.Hours.name))]),n("div",{staticClass:"tabBody"},[n("el-row",[n("el-radio",{attrs:{label:"1"},model:{value:e.hour.cronEvery,callback:function(t){e.$set(e.hour,"cronEvery",t)},expression:"hour.cronEvery"}},[e._v(e._s(e.text.Hours.every))])],1),n("el-row",[n("el-radio",{attrs:{label:"2"},model:{value:e.hour.cronEvery,callback:function(t){e.$set(e.hour,"cronEvery",t)},expression:"hour.cronEvery"}},[e._v(e._s(e.text.Hours.interval[0])+" "),n("el-input-number",{attrs:{size:"small",min:0,max:23},model:{value:e.hour.incrementIncrement,callback:function(t){e.$set(e.hour,"incrementIncrement",t)},expression:"hour.incrementIncrement"}}),e._v(" "+e._s(e.text.Hours.interval[1])+" "),n("el-input-number",{attrs:{size:"small",min:0,max:23},model:{value:e.hour.incrementStart,callback:function(t){e.$set(e.hour,"incrementStart",t)},expression:"hour.incrementStart"}}),e._v(" "+e._s(e.text.Hours.interval[2])+" ")],1)],1),n("el-row",[n("el-radio",{staticClass:"long",attrs:{label:"3"},model:{value:e.hour.cronEvery,callback:function(t){e.$set(e.hour,"cronEvery",t)},expression:"hour.cronEvery"}},[e._v(e._s(e.text.Hours.specific)+" "),n("el-select",{attrs:{size:"small",multiple:""},model:{value:e.hour.specificSpecific,callback:function(t){e.$set(e.hour,"specificSpecific",t)},expression:"hour.specificSpecific"}},e._l(24,(function(e){return n("el-option",{key:e,attrs:{value:(e-1).toString(),label:e-1}})})),1)],1)],1),n("el-row",[n("el-radio",{attrs:{label:"4"},model:{value:e.hour.cronEvery,callback:function(t){e.$set(e.hour,"cronEvery",t)},expression:"hour.cronEvery"}},[e._v(e._s(e.text.Hours.cycle[0])+" "),n("el-input-number",{attrs:{size:"small",min:0,max:23},model:{value:e.hour.rangeStart,callback:function(t){e.$set(e.hour,"rangeStart",t)},expression:"hour.rangeStart"}}),e._v(" "+e._s(e.text.Hours.cycle[1])+" "),n("el-input-number",{attrs:{size:"small",min:0,max:23},model:{value:e.hour.rangeEnd,callback:function(t){e.$set(e.hour,"rangeEnd",t)},expression:"hour.rangeEnd"}}),e._v(" "+e._s(e.text.Hours.cycle[2])+" ")],1)],1)],1)]),n("el-tab-pane",[n("span",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"el-icon-date"}),e._v(" "+e._s(e.text.Day.name))]),n("div",{staticClass:"tabBody"},[n("el-row",[n("el-radio",{attrs:{label:"1"},model:{value:e.day.cronEvery,callback:function(t){e.$set(e.day,"cronEvery",t)},expression:"day.cronEvery"}},[e._v(e._s(e.text.Day.every))])],1),n("el-row",[n("el-radio",{attrs:{label:"2"},model:{value:e.day.cronEvery,callback:function(t){e.$set(e.day,"cronEvery",t)},expression:"day.cronEvery"}},[e._v(e._s(e.text.Day.intervalDay[0])+" "),n("el-input-number",{attrs:{size:"small",min:1,max:31},model:{value:e.day.incrementIncrement,callback:function(t){e.$set(e.day,"incrementIncrement",t)},expression:"day.incrementIncrement"}}),e._v(" "+e._s(e.text.Day.intervalDay[1])+" "),n("el-input-number",{attrs:{size:"small",min:1,max:31},model:{value:e.day.incrementStart,callback:function(t){e.$set(e.day,"incrementStart",t)},expression:"day.incrementStart"}}),e._v(" "+e._s(e.text.Day.intervalDay[2])+" ")],1)],1),n("el-row",[n("el-radio",{staticClass:"long",attrs:{label:"3"},model:{value:e.day.cronEvery,callback:function(t){e.$set(e.day,"cronEvery",t)},expression:"day.cronEvery"}},[e._v(e._s(e.text.Day.specificDay)+" "),n("el-select",{attrs:{size:"small",multiple:""},model:{value:e.day.specificSpecific,callback:function(t){e.$set(e.day,"specificSpecific",t)},expression:"day.specificSpecific"}},e._l(31,(function(e){return n("el-option",{key:e,attrs:{value:e.toString(),label:e}})})),1)],1)],1),n("el-row",[n("el-radio",{attrs:{label:"4"},model:{value:e.day.cronEvery,callback:function(t){e.$set(e.day,"cronEvery",t)},expression:"day.cronEvery"}},[e._v(e._s(e.text.Day.cycle[0])+" "),n("el-input-number",{attrs:{size:"small",min:1,max:31},model:{value:e.day.rangeStart,callback:function(t){e.$set(e.day,"rangeStart",t)},expression:"day.rangeStart"}}),e._v(" "+e._s(e.text.Day.cycle[1])+" "),n("el-input-number",{attrs:{size:"small",min:1,max:31},model:{value:e.day.rangeEnd,callback:function(t){e.$set(e.day,"rangeEnd",t)},expression:"day.rangeEnd"}})],1)],1)],1)]),n("el-tab-pane",[n("span",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"el-icon-date"}),e._v(" "+e._s(e.text.Month.name))]),n("div",{staticClass:"tabBody"},[n("el-row",[n("el-radio",{attrs:{label:"1"},model:{value:e.month.cronEvery,callback:function(t){e.$set(e.month,"cronEvery",t)},expression:"month.cronEvery"}},[e._v(e._s(e.text.Month.every))])],1),n("el-row",[n("el-radio",{attrs:{label:"2"},model:{value:e.month.cronEvery,callback:function(t){e.$set(e.month,"cronEvery",t)},expression:"month.cronEvery"}},[e._v(e._s(e.text.Month.interval[0])+" "),n("el-input-number",{attrs:{size:"small",min:0,max:12},model:{value:e.month.incrementIncrement,callback:function(t){e.$set(e.month,"incrementIncrement",t)},expression:"month.incrementIncrement"}}),e._v(" "+e._s(e.text.Month.interval[1])+" "),n("el-input-number",{attrs:{size:"small",min:0,max:12},model:{value:e.month.incrementStart,callback:function(t){e.$set(e.month,"incrementStart",t)},expression:"month.incrementStart"}})],1)],1),n("el-row",[n("el-radio",{staticClass:"long",attrs:{label:"3"},model:{value:e.month.cronEvery,callback:function(t){e.$set(e.month,"cronEvery",t)},expression:"month.cronEvery"}},[e._v(e._s(e.text.Month.specific)+" "),n("el-select",{attrs:{size:"small",multiple:""},model:{value:e.month.specificSpecific,callback:function(t){e.$set(e.month,"specificSpecific",t)},expression:"month.specificSpecific"}},e._l(12,(function(e){return n("el-option",{key:e,attrs:{label:e,value:e.toString()}})})),1)],1)],1),n("el-row",[n("el-radio",{attrs:{label:"4"},model:{value:e.month.cronEvery,callback:function(t){e.$set(e.month,"cronEvery",t)},expression:"month.cronEvery"}},[e._v(e._s(e.text.Month.cycle[0])+" "),n("el-input-number",{attrs:{size:"small",min:1,max:12},model:{value:e.month.rangeStart,callback:function(t){e.$set(e.month,"rangeStart",t)},expression:"month.rangeStart"}}),e._v(" "+e._s(e.text.Month.cycle[1])+" "),n("el-input-number",{attrs:{size:"small",min:1,max:12},model:{value:e.month.rangeEnd,callback:function(t){e.$set(e.month,"rangeEnd",t)},expression:"month.rangeEnd"}}),e._v(" "+e._s(e.text.Month.cycle[2])+" ")],1)],1)],1)]),n("el-tab-pane",[n("span",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"el-icon-date"}),e._v(" "+e._s(e.text.Week.name))]),n("div",{staticClass:"tabBody"},[n("el-row",[n("el-radio",{attrs:{label:"1"},model:{value:e.week.cronEvery,callback:function(t){e.$set(e.week,"cronEvery",t)},expression:"week.cronEvery"}},[e._v(e._s(e.text.Week.every))])],1),n("el-row",[n("el-radio",{staticClass:"long",attrs:{label:"3"},model:{value:e.week.cronEvery,callback:function(t){e.$set(e.week,"cronEvery",t)},expression:"week.cronEvery"}},[e._v(e._s(e.text.Week.specific)+" "),n("el-select",{attrs:{size:"small",multiple:""},model:{value:e.week.specificSpecific,callback:function(t){e.$set(e.week,"specificSpecific",t)},expression:"week.specificSpecific"}},e._l(7,(function(t){return n("el-option",{key:t,attrs:{label:e.text.Week.list[t-1],value:t.toString()}})})),1)],1)],1),n("el-row",[n("el-radio",{attrs:{label:"4"},model:{value:e.week.cronEvery,callback:function(t){e.$set(e.week,"cronEvery",t)},expression:"week.cronEvery"}},[e._v(e._s(e.text.Week.cycle[0])+" "),n("el-input-number",{attrs:{size:"small",min:1,max:7},model:{value:e.week.rangeStart,callback:function(t){e.$set(e.week,"rangeStart",t)},expression:"week.rangeStart"}}),e._v(" "+e._s(e.text.Week.cycle[1])+" "),n("el-input-number",{attrs:{size:"small",min:1,max:7},model:{value:e.week.rangeEnd,callback:function(t){e.$set(e.week,"rangeEnd",t)},expression:"week.rangeEnd"}})],1)],1)],1)])],1)],1)},u=[],m=(n("dbb3"),n("9302"),n("77ad"),n("e50e"),n("e18c"),n("e35a"),n("1c2e"),n("f4e3"),n("0d7a"),{Seconds:{name:"Seconds",every:"Every second",interval:["Every","second(s) starting at second"],specific:"Specific second (choose one or many)",cycle:["Every second between second","and second"]},Minutes:{name:"Minutes",every:"Every minute",interval:["Every","minute(s) starting at minute"],specific:"Specific minute (choose one or many)",cycle:["Every minute between minute","and minute"]},Hours:{name:"Hours",every:"Every hour",interval:["Every","hour(s) starting at hour"],specific:"Specific hour (choose one or many)",cycle:["Every hour between hour","and hour"]},Day:{name:"Day",every:"Every day",intervalWeek:["Every","day(s) starting on"],intervalDay:["Every","day(s) starting at the","of the month"],specificWeek:"Specific day of week (choose one or many)",specificDay:"Specific day of month (choose one or many)",lastDay:"On the last day of the month",lastWeekday:"On the last weekday of the month",lastWeek:["On the last"," of the month"],beforeEndMonth:["day(s) before the end of the month"],nearestWeekday:["Nearest weekday (Monday to Friday) to the","of the month"],someWeekday:["On the","of the month"],cycle:["From","to"]},Week:{name:"Week",every:"Every day",specific:"Specific weekday (choose on or many)",list:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],cycle:["From","to"]},Month:{name:"Month",every:"Every month",interval:["Every","month(s) starting in"],specific:"Specific month (choose one or many)",cycle:["Every month between","and"]},Year:{name:"Year",every:"Any year",interval:["Every","year(s) starting in"],specific:"Specific year (choose one or many)",cycle:["Every year between","and"]},Save:"Save",Close:"Close"}),p={Seconds:{name:"秒",every:"每一秒钟",interval:["每隔","秒执行 从","秒开始"],specific:"具体秒数(可多选)",cycle:["周期从","到","秒"]},Minutes:{name:"分",every:"每一分钟",interval:["每隔","分执行 从","分开始"],specific:"具体分钟数(可多选)",cycle:["周期从","到","分"]},Hours:{name:"时",every:"每一小时",interval:["每隔","小时执行 从","小时开始"],specific:"具体小时数(可多选)",cycle:["周期从","到","小时"]},Day:{name:"天",every:"每一天",intervalWeek:["每隔","周执行 从","开始"],intervalDay:["每隔","天执行 从","天开始"],specificWeek:"具体星期几(可多选)",specificDay:"具体天数(可多选)",lastDay:"在这个月的最后一天",lastWeekday:"在这个月的最后一个工作日",lastWeek:["在这个月的最后一个"],beforeEndMonth:["在本月底前","天"],nearestWeekday:["最近的工作日（周一至周五）至本月","日"],someWeekday:["在这个月的第","个"],cycle:["从","到"]},Week:{name:"周",every:"每天",specific:"具体天数(可多选)",list:["一","二","三","四","五","六","天"].map((function(e){return"星期"+e})),cycle:["从","到"]},Month:{name:"月",every:"每一月",interval:["每隔","月执行 从","月开始"],specific:"具体月数(可多选)",cycle:["从","到","月之间的每个月"]},Year:{name:"年",every:"每一年",interval:["每隔","年执行 从","年开始"],specific:"具体年份(可多选)",cycle:["从","到","年之间的每一年"]},Save:"保存",Close:"关闭"},h={en:m,cn:p},f={name:"VueCronLinux",props:["data","i18n"],data:function(){return{second:{cronEvery:"",incrementStart:"3",incrementIncrement:"5",rangeStart:"",rangeEnd:"",specificSpecific:[0]},minute:{cronEvery:"",incrementStart:"3",incrementIncrement:"5",rangeStart:"",rangeEnd:"",specificSpecific:["0"]},hour:{cronEvery:"",incrementStart:"3",incrementIncrement:"5",rangeStart:"",rangeEnd:"",specificSpecific:["0"]},day:{cronEvery:"",incrementStart:"1",incrementIncrement:"1",rangeStart:"",rangeEnd:"",specificSpecific:["1"],cronLastSpecificDomDay:1,cronDaysBeforeEomMinus:"",cronDaysNearestWeekday:""},month:{cronEvery:"",incrementStart:"3",incrementIncrement:"5",rangeStart:"",rangeEnd:"",specificSpecific:["1"]},week:{cronEvery:"",incrementStart:"1",incrementIncrement:"1",specificSpecific:["1"],cronNthDayDay:1,cronNthDayNth:"1",rangeStart:"",rangeEnd:""},output:{second:"",minute:"",hour:"",day:"",month:"",Week:"",year:""}}},computed:{text:function(){return h[this.i18n||"cn"]},minutesText:function(){var e="",t=this.minute.cronEvery;switch(t.toString()){case"1":e="*";break;case"2":e=this.minute.incrementStart+"/"+this.minute.incrementIncrement;break;case"3":this.minute.specificSpecific.map((function(t){e+=t+","})),e=e.slice(0,-1);break;case"4":e=this.minute.rangeStart+"-"+this.minute.rangeEnd;break}return e},hoursText:function(){var e="",t=this.hour.cronEvery;switch(t.toString()){case"1":e="*";break;case"2":e=this.hour.incrementStart+"/"+this.hour.incrementIncrement;break;case"3":this.hour.specificSpecific.map((function(t){e+=t+","})),e=e.slice(0,-1);break;case"4":e=this.hour.rangeStart+"-"+this.hour.rangeEnd;break}return e},daysText:function(){var e="",t=this.day.cronEvery;switch(t.toString()){case"1":e="*";break;case"2":e=this.day.incrementStart+"/"+this.day.incrementIncrement;break;case"3":this.day.specificSpecific.map((function(t){e+=t+","})),e=e.slice(0,-1);break;case"4":e=this.day.rangeStart+"-"+this.day.rangeEnd;break}return e},monthsText:function(){var e="",t=this.month.cronEvery;switch(t.toString()){case"1":e="*";break;case"2":e=this.month.incrementStart+"/"+this.month.incrementIncrement;break;case"3":this.month.specificSpecific.map((function(t){e+=t+","})),e=e.slice(0,-1);break;case"4":e=this.month.rangeStart+"-"+this.month.rangeEnd;break}return e},weeksText:function(){var e="",t=this.week.cronEvery;switch(t.toString()){case"1":e="*";break;case"3":this.week.specificSpecific.map((function(t){e+=t+","})),e=e.slice(0,-1);break;case"4":e=this.week.rangeStart+"-"+this.week.rangeEnd;break}return e},cron:function(){return[this.minutesText,this.hoursText,this.daysText,this.monthsText,this.weeksText].filter((function(e){return!!e})).join(" ")}},watch:{data:function(){this.updateCronFromData()},cron:function(){this.$emit("change",this.cron)}},mounted:function(){this.updateCronFromData()},methods:{change:function(){this.$emit("change",this.cron),this.close()},close:function(){this.$emit("close")},submit:function(){return this.validate()?(this.$emit("submit",this.cron),!0):(this.$message.error(this.$t("Cron expression is invalid")),!1)},validate:function(){return!!this.minutesText&&(!!this.hoursText&&(!!this.daysText&&(!!this.monthsText&&!!this.weeksText)))},updateCronItem:function(e,t){void 0!==t?t.match(/^\*$/)?this[e].cronEvery="1":t.match(/\//)?(this[e].cronEvery="2",this[e].incrementStart=t.split("/")[0],this[e].incrementIncrement=t.split("/")[1]):t.match(/,|^\d+$/)?(this[e].cronEvery="3",this[e].specificSpecific=t.split(",")):t.match(/-/)?(this[e].cronEvery="4",this[e].rangeStart=t.split("-")[0],this[e].rangeEnd=t.split("-")[1]):this[e].cronEvery="0":this[e].cronEvery="0"},updateCronFromData:function(){var e=this.data.split(" "),t=e[0],n=e[1],r=e[2],s=e[3],i=e[4];this.updateCronItem("minute",t),this.updateCronItem("hour",n),this.updateCronItem("day",r),this.updateCronItem("month",s),this.updateCronItem("week",i)}}},b=f,v=(n("9941"),n("9ca4")),y=Object(v["a"])(b,d,u,!1,null,"68a49ec3",null),_=y.exports,S=n("9f3a"),g=n("4a4e"),$=n("b2914"),k={name:"ScheduleTaskList",extends:$["default"],computed:Object(o["a"])(Object(o["a"])({},Object(S["c"])("task",["filter"])),Object(S["c"])("schedule",["scheduleForm"])),created:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.update();case 1:case"end":return t.stop()}}),t)})))()},methods:{update:function(){this.isFilterSpiderDisabled=!0,this.$set(this.filter,"spider_id",this.scheduleForm.spider_id),this.filter.schedule_id=this.scheduleForm._id,this.$store.dispatch("task/getTaskList")}}},w=k,x=Object(v["a"])(w,r,s,!1,null,null,null),E=x.exports,C=n("1732"),D=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{visible:e.visible,width:"1200px","before-close":e.beforeClose}},[n("el-table",{attrs:{data:e.batchScheduleList}},[n("el-table-column",{attrs:{label:e.$t("Schedule Name"),width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-input",{attrs:{size:"mini",placeholder:e.$t("Schedule Name")},model:{value:t.row.name,callback:function(n){e.$set(t.row,"name",n)},expression:"scope.row.name"}})]}}])}),n("el-table-column",{attrs:{label:e.$t("Cron"),width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-input",{attrs:{size:"mini",placeholder:e.$t("Cron")},model:{value:t.row.cron,callback:function(n){e.$set(t.row,"cron",n)},expression:"scope.row.cron"}})]}}])}),n("el-table-column",{attrs:{label:e.$t("Spider"),width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-select",{attrs:{size:"mini",filterable:"",placeholder:e.$t("Spider")},on:{change:function(n){return e.onSpiderChange(t.row,n)}},model:{value:t.row.spider_id,callback:function(n){e.$set(t.row,"spider_id",n)},expression:"scope.row.spider_id"}},e._l(e.allSpiderList,(function(e){return n("el-option",{key:e._id,attrs:{label:e.display_name+" ("+e.name+")",value:e._id}})})),1)]}}])}),n("el-table-column",{attrs:{label:e.$t("Run Type"),width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-select",{attrs:{size:"mini"},model:{value:t.row.run_type,callback:function(n){e.$set(t.row,"run_type",n)},expression:"scope.row.run_type"}},[n("el-option",{attrs:{value:"all-nodes",label:e.$t("All Nodes")}}),n("el-option",{attrs:{value:"selected-nodes",label:e.$t("Selected Nodes")}}),n("el-option",{attrs:{value:"random",label:e.$t("Random")}})],1)]}}])}),n("el-table-column",{attrs:{label:e.$t("Nodes"),width:"250px"},scopedSlots:e._u([{key:"default",fn:function(t){return"selected-nodes"===t.row.run_type?[n("el-select",{attrs:{size:"mini",multiple:"",placeholder:e.$t("Nodes")},model:{value:t.row.node_ids,callback:function(n){e.$set(t.row,"node_ids",n)},expression:"scope.row.node_ids"}},e._l(e.activeNodeList,(function(e){return n("el-option",{key:e._id,attrs:{label:e.name,value:e._id}})})),1)]:void 0}}],null,!0)}),n("el-table-column",{attrs:{label:e.$t("Scrapy Spider"),width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return e.getSpiderById(t.row.spider_id).is_scrapy?[n("el-select",{attrs:{size:"mini",placeholder:e.$t("Scrapy Spider"),disabled:!t.row.scrapy_spider_name},model:{value:t.row.scrapy_spider_name,callback:function(n){e.$set(t.row,"scrapy_spider_name",n)},expression:"scope.row.scrapy_spider_name"}},e._l(e.getScrapySpiderNames(t.row.spider_id),(function(e,t){return n("el-option",{key:t,attrs:{label:e,value:e}})})),1)]:void 0}}],null,!0)}),n("el-table-column",{attrs:{label:e.$t("Scrapy Log Level"),width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return e.getSpiderById(t.row.spider_id).is_scrapy?[n("el-select",{attrs:{placeholder:e.$t("Scrapy Log Level"),size:"mini"},model:{value:t.row.scrapy_log_level,callback:function(n){e.$set(t.row,"scrapy_log_level",n)},expression:"scope.row.scrapy_log_level"}},[n("el-option",{attrs:{value:"INFO",label:"INFO"}}),n("el-option",{attrs:{value:"DEBUG",label:"DEBUG"}}),n("el-option",{attrs:{value:"WARN",label:"WARN"}}),n("el-option",{attrs:{value:"ERROR",label:"ERROR"}})],1)]:void 0}}],null,!0)}),n("el-table-column",{attrs:{label:e.$t("Parameters"),"min-width":"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-input",{attrs:{size:"mini",placeholder:e.$t("Parameters")},model:{value:t.param,callback:function(n){e.$set(t,"param",n)},expression:"scope.param"}})]}}])}),n("el-table-column",{attrs:{label:e.$t("Description"),width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-input",{attrs:{size:"mini",type:"textarea",placeholder:e.$t("Description")},model:{value:t.row.description,callback:function(n){e.$set(t.row,"description",n)},expression:"scope.row.description"}})]}}])}),n("el-table-column",{attrs:{label:e.$t("Action"),fixed:"right",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{icon:"el-icon-plus",size:"mini",type:"primary"},on:{click:function(n){return e.onAdd(t.$index)}}}),n("el-button",{attrs:{icon:"el-icon-delete",size:"mini",type:"danger"},on:{click:function(n){return e.onRemove(t.$index)}}})]}}])})],1),n("template",{slot:"footer"},[n("el-button",{attrs:{type:"plain",size:"small"},on:{click:function(t){return e.$emit("close")}}},[e._v(e._s(e.$t("Cancel")))]),n("el-button",{attrs:{type:"plain",size:"small"},on:{click:e.reset}},[e._v(" "+e._s(e.$t("Reset"))+" ")]),n("el-button",{attrs:{type:"primary",size:"small",disabled:e.isConfirmDisabled},on:{click:e.onConfirm}},[e._v(" "+e._s(e.$t("Confirm"))+" ")])],1)],2)},F=[],L=(n("b4fb"),n("fe59"),n("98e0"),n("ea69"),n("053b"),n("34d9"),n("96db"),n("08ba"),n("af86"),{name:"BatchAddScheduleDialog",props:{visible:{type:Boolean,default:!1}},data:function(){return{scrapySpidersNamesDict:{}}},computed:Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(S["c"])("schedule",["batchScheduleList"])),Object(S["c"])("spider",["allSpiderList"])),Object(S["c"])("node",["nodeList"])),{},{activeNodeList:function(){return this.nodeList.filter((function(e){return"online"===e.status}))},validScheduleList:function(){return this.batchScheduleList.filter((function(e){return!!e.spider_id&&!!e.name&&!!e.cron}))},isConfirmDisabled:function(){if(0===this.validScheduleList.length)return!0;for(var e=0;e<this.validScheduleList.length;e++){var t=this.validScheduleList[e],n=this.getSpiderById(t.spider_id);if(!n)return!0;if(n.is_scrapy&&!t.scrapy_spider_name)return!0}return!1},scrapySpidersIds:function(){var e=this;return Array.from(new Set(this.validScheduleList.filter((function(t){var n=e.getSpiderById(t.spider_id);return n&&n.is_scrapy})).map((function(e){return e.spider_id}))))}}),watch:{visible:function(){this.visible&&this.fetchAllScrapySpiderNames()}},methods:{beforeClose:function(){this.$emit("close")},reset:function(){this.$store.commit("task/SET_BATCH_CRAWL_LIST",[]);for(var e=0;e<10;e++)this.batchScheduleList.push({spider_id:"",run_type:"random",param:"",scrapy_log_level:"INFO"});this.$st.sendEv("批量添加定时任务","重置")},getSpiderById:function(e){return this.allSpiderList.filter((function(t){return t._id===e}))[0]||{}},onSpiderChange:function(e,t){var n=this;return Object(l["a"])(regeneratorRuntime.mark((function r(){var s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(s=n.getSpiderById(t),s){r.next=3;break}return r.abrupt("return");case 3:if(!s.is_scrapy){r.next=7;break}return r.next=6,n.fetchScrapySpiderNames(t);case 6:n.scrapySpidersNamesDict[t]&&n.scrapySpidersNamesDict[t].length>0&&n.$set(e,"scrapy_spider_name",n.scrapySpidersNamesDict[t][0]);case 7:n.$st.sendEv("批量添加定时任务","选择爬虫");case 8:case"end":return r.stop()}}),r)})))()},getScrapySpiderNames:function(e){return this.scrapySpidersNamesDict[e]?this.scrapySpidersNamesDict[e]:[]},onConfirm:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$request.put("/schedules/batch",e.validScheduleList.map((function(t){var n=e.getSpiderById(t.spider_id);return"customized"===n.type&&n.is_scrapy&&(t.param="".concat(e.scrapySpidersNamesDict[t.spider_id]?e.scrapySpidersNamesDict[t.spider_id][0]:""," --loglevel=").concat(t.scrapy_log_level," ").concat(t.param||"")),t.cron="0 "+t.cron,t})));case 2:if(n=t.sent,200===n.status){t.next=6;break}return e.$message.error(n.data.error),t.abrupt("return");case 6:e.reset(),e.$emit("close"),e.$emit("confirm"),e.$st.sendEv("批量添加定时任务","确认添加");case 10:case"end":return t.stop()}}),t)})))()},fetchScrapySpiderNames:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.scrapySpidersNamesDict[e]){n.next=5;break}return n.next=3,t.$request.get("/spiders/".concat(e,"/scrapy/spiders"));case 3:r=n.sent,t.$set(t.scrapySpidersNamesDict,e,r.data.data);case 5:case"end":return n.stop()}}),n)})))()},fetchAllScrapySpiderNames:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(e.scrapySpidersIds.map(function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.fetchScrapySpiderNames(n);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 2:e.validScheduleList.filter((function(t){var n=e.getSpiderById(t.spider_id);return n&&n.is_scrapy})).forEach((function(t){var n=t.spider_id;e.scrapySpidersNamesDict[n]&&e.scrapySpidersNamesDict[n].length>0&&e.$set(t,"scrapy_spider_name",e.scrapySpidersNamesDict[n][0])}));case 3:case"end":return t.stop()}}),t)})))()},onAdd:function(e){this.batchScheduleList.splice(e+1,0,{spider_id:"",run_type:"random",param:"",scrapy_log_level:"INFO"}),this.$st.sendEv("批量添加定时任务","添加")},onRemove:function(e){this.batchScheduleList.splice(e,1),this.$st.sendEv("批量添加定时任务","删除")}}}),R=L,T=(n("4a60"),Object(v["a"])(R,D,F,!1,null,"601dd9e2",null)),N=T.exports,O={name:"ScheduleList",components:{BatchAddScheduleDialog:N,CrawlConfirmDialog:C["a"],ScheduleTaskList:E,VueCronLinux:_,ParametersDialog:g["a"]},data:function(){var e=this;return{columns:[{name:"name",label:"Name",width:"150px"},{name:"cron",label:"Cron",width:"120px"},{name:"run_type",label:"Run Type",width:"120px"},{name:"node_names",label:"Node",width:"150px"},{name:"spider_name",label:"Spider",width:"150px"},{name:"scrapy_spider",label:"Scrapy Spider",width:"150px"},{name:"param",label:"Parameters",width:"150px"},{name:"description",label:"Description",width:"200px"},{name:"enable",label:"Enable/Disable",width:"120px"},{name:"username",label:"Owner",width:"100px"}],isEdit:!1,dialogTitle:"",dialogVisible:!1,cronDialogVisible:!1,batchAddDialogVisible:!1,expression:"",nodeList:[],isShowCron:!1,isLoading:!1,isParametersVisible:!1,isViewTasksDialogVisible:!1,crawlConfirmDialogVisible:!1,selectedSchedules:[],tourSteps:[{target:".table",content:this.$t('This is a list of schedules (cron jobs) to periodically run spider tasks. You can add/modify/edit your schedules here.<br><br>For more information, please refer to the <a href="https://docs.crawlab.cn/Usage/Schedule/" target="_blank" style="color: #409EFF">Documentation (Chinese)</a> for detail.')},{target:".btn-add",content:this.$t("You can add a new schedule by clicking this button.")}],tourCallbacks:{onStop:function(){e.$utils.tour.finishTour("schedule-list")},onPreviousStep:function(t){2===t&&(e.dialogVisible=!1),e.$utils.tour.prevStep("schedule-list",t)},onNextStep:function(t){1===t&&(e.isEdit=!1,e.dialogVisible=!0,e.$store.commit("schedule/SET_SCHEDULE_FORM",{node_ids:[]})),e.$utils.tour.nextStep("schedule-list",t)}},tourAddSteps:[{target:".add-form",content:this.$t("You should fill the form before adding the new schedule."),params:{placement:"right"}},{target:"#schedule-name",content:this.$t("The name of the schedule"),params:{placement:"right"}},{target:"#run-type",content:this.$t('The type of how to run the task.<br><br>Please refer to the <a href="https://docs.crawlab.cn/Usage/Spider/Run.html" target="_blank" style="color: #409EFF">Documentation (Chinese)</a> for detailed explanation for the options.<br><br>Let\'s select <strong>Selected Nodes</strong> for example.'),params:{placement:"right"}},{target:"#spider-id",content:this.$t("The spider to run"),params:{placement:"right"}},{target:"#cron",content:this.$t('<strong>Cron</strong> expression for the schedule.<br><br>If you are not sure what a cron expression is, please refer to this <a href="https://baike.baidu.com/item/crontab/8819388" target="_blank" style="color: #409EFF">Article</a>.'),params:{placement:"right"}},{target:"#change-crontab",content:this.$t("You can select the correct options in the cron config box to configure the cron expression."),params:{placement:"top"}},{target:"#param",content:this.$t("The parameters which will be passed into the spider program."),params:{placement:"right"}},{target:"#schedule-description",content:this.$t("The description for the schedule"),params:{placement:"right"}},{target:"#btn-submit",content:this.$t("Once you have filled all fields, click this button to submit."),params:{placement:"right"}}],tourAddCallbacks:{onStop:function(){e.$utils.tour.finishTour("schedule-list-add")},onPreviousStep:function(t){4===t?e.isShowCron=!1:6===t&&(e.isShowCron=!0),e.$utils.tour.prevStep("schedule-list-add",t)},onNextStep:function(t){3===t?e.isShowCron=!0:5===t&&(e.isShowCron=!1),e.$utils.tour.nextStep("schedule-list-add",t)}}}},computed:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(S["c"])("spider",["allSpiderList","spiderForm"])),Object(S["c"])("schedule",["scheduleList","scheduleForm","batchScheduleList"])),{},{lang:function(){var e=this.$store.state.lang.lang||window.localStorage.getItem("lang");return e?"zh"===e?"cn":"en":"cn"},filteredTableData:function(){return this.scheduleList},spider:function(){for(var e=0;e<this.allSpiderList.length;e++)if(this.allSpiderList[e]._id===this.scheduleForm.spider_id)return this.allSpiderList[e];return{}},isDisabledSpiderSchedule:function(){return!1}}),created:function(){var e=this;this.$store.dispatch("schedule/getScheduleList"),c["a"].get("/nodes",{}).then((function(t){e.nodeList=t.data.data.map((function(e){return e.systemInfo={os:"",arch:"",num_cpu:"",executables:[]},e}))})),this.$store.dispatch("spider/getAllSpiderList"),this.$store.dispatch("node/getNodeList")},mounted:function(){this.isDisabledSpiderSchedule||this.$utils.tour.isFinishedTour("schedule-list")||this.$utils.tour.startTour(this,"schedule-list")},methods:{onDialogClose:function(){this.dialogVisible=!1},onCancel:function(){this.dialogVisible=!1},onAdd:function(){var e=this;this.isEdit=!1,this.dialogVisible=!0,this.$store.commit("schedule/SET_SCHEDULE_FORM",{node_ids:[]}),this.$st.sendEv("定时任务","添加定时任务"),this.$utils.tour.isFinishedTour("schedule-list-add")||setTimeout((function(){e.$utils.tour.startTour(e,"schedule-list-add")}),500)},onAddSubmit:function(){var e=this;this.$refs.scheduleForm.validate((function(t){if(t){var n=JSON.parse(JSON.stringify(e.scheduleForm));n.cron="0 "+e.scheduleForm.cron,e.isEdit?c["a"].post("/schedules/".concat(e.scheduleForm._id),n).then((function(t){t.data.error?e.$message.error(t.data.error):(e.dialogVisible=!1,e.$store.dispatch("schedule/getScheduleList"),e.$message.success(e.$t("The schedule has been saved")))})):c["a"].put("/schedules",n).then((function(t){t.data.error?e.$message.error(t.data.error):(e.dialogVisible=!1,e.$store.dispatch("schedule/getScheduleList"),e.$message.success(e.$t("The schedule has been added")))}))}})),this.$st.sendEv("定时任务","提交定时任务")},onBatchAdd:function(){this.$store.commit("schedule/SET_BATCH_SCHEDULE_LIST",[]);for(var e=0;e<10;e++)this.batchScheduleList.push({name:"",cron:"",spider_id:"",run_type:"random",param:"",scrapy_log_level:"INFO",description:""});this.batchAddDialogVisible=!0,this.$st.sendEv("定时任务","点击批量添加定时任务")},onRemoveSelectedSchedules:function(){var e=this;this.$confirm(this.$t("Are you sure to delete selected items?"),this.$t("Notification"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning"}).then(Object(l["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$request["delete"]("/schedules",{ids:e.selectedSchedules.map((function(e){return e._id}))});case 3:if(n=t.sent,n.data.error){t.next=9;break}return e.$message.success(e.$t("Deleted successfully")),e.$refs["table"].clearSelection(),t.next=9,e.$store.dispatch("schedule/getScheduleList");case 9:return t.prev=9,t.finish(9);case 11:e.$st.sendEv("定时任务","批量删除定时任务");case 12:case"end":return t.stop()}}),t,null,[[0,,9,11]])}))))},onBatchEnable:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$request.post("/schedules-set-enabled",{schedule_ids:e.selectedSchedules.map((function(e){return e._id})),enabled:!0});case 2:return e.$message.success("Enabled successfully"),e.$refs["table"].clearSelection(),t.next=6,e.$store.dispatch("schedule/getScheduleList");case 6:e.$st.sendEv("定时任务","批量启用定时任务");case 7:case"end":return t.stop()}}),t)})))()},onBatchDisable:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$request.post("/schedules-set-enabled",{schedule_ids:e.selectedSchedules.map((function(e){return e._id})),enabled:!1});case 2:return e.$message.success("Disabled successfully"),e.$refs["table"].clearSelection(),t.next=6,e.$store.dispatch("schedule/getScheduleList");case 6:e.$st.sendEv("定时任务","批量禁用定时任务");case 7:case"end":return t.stop()}}),t)})))()},isShowRun:function(e){},onEdit:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.$store.commit("schedule/SET_SCHEDULE_FORM",e),t.dialogVisible=!0,t.isEdit=!0,t.$st.sendEv("定时任务","修改定时任务"),t.isLoading=!0,t.scheduleForm.scrapy_log_level||t.$set(t.scheduleForm,"scrapy_log_level","INFO"),n.next=8,t.$store.dispatch("spider/getSpiderData",e.spider_id);case 8:if(!t.spiderForm.is_scrapy){n.next=12;break}return n.next=11,t.$store.dispatch("spider/getSpiderScrapySpiders",e.spider_id);case 11:t.scheduleForm.scrapy_spider||t.spiderForm.spider_names&&t.spiderForm.spider_names.length>0&&t.$set(t.scheduleForm,"scrapy_spider",t.spiderForm.spider_names[0]);case 12:t.isLoading=!1;case 13:case"end":return n.stop()}}),n)})))()},onRemove:function(e){var t=this;this.$confirm(this.$t("Are you sure to delete the schedule task?"),this.$t("Notification"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning"}).then((function(){t.$store.dispatch("schedule/removeSchedule",e._id).then((function(){setTimeout((function(){t.$store.dispatch("schedule/getScheduleList"),t.$message.success(t.$t("The schedule has been removed"))}),100)}))}))["catch"]((function(){})),this.$st.sendEv("定时任务","删除定时任务")},isDisabledSpider:function(e){return"customized"===e.type&&!e.cmd},onEnabledChange:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!e.enabled){n.next=6;break}return n.next=3,t.$store.dispatch("schedule/enableSchedule",e._id);case 3:r=n.sent,n.next=9;break;case 6:return n.next=8,t.$store.dispatch("schedule/disableSchedule",e._id);case 8:r=n.sent;case 9:!r||r.data.error?t.$message.error(t.$t("".concat(e.enabled?"Enabling":"Disabling"," the schedule unsuccessful"))):t.$message.success(t.$t("".concat(e.enabled?"Enabling":"Disabling"," the schedule successful"))),t.$st.sendEv("定时任务","启用/禁用");case 11:case"end":return n.stop()}}),n)})))()},onCronChange:function(e){this.$set(this.scheduleForm,"cron",e),this.$st.sendEv("定时任务","配置Cron")},onCronDialogSubmit:function(){var e=this.$refs["vue-cron-linux"].submit();e&&(this.cronDialogVisible=!1)},onOpenParameters:function(){this.isParametersVisible=!0},onParametersConfirm:function(e){this.scheduleForm.param=e,this.isParametersVisible=!1},onSpiderChange:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$store.dispatch("spider/getSpiderData",e);case 2:if("customized"!==t.spiderForm.type||!t.spiderForm.is_scrapy){n.next=9;break}return t.isLoading=!0,n.next=6,t.$store.dispatch("spider/getSpiderScrapySpiders",e);case 6:t.isLoading=!1,t.$set(t.scheduleForm,"scrapy_spider",t.spiderForm.spider_names[0]),t.$set(t.scheduleForm,"scrapy_log_level","INFO");case 9:case"end":return n.stop()}}),n)})))()},onShowCronDialog:function(){this.cronDialogVisible=!0,this.$st.sendEv("定时任务","点击编辑Cron")},onViewTasks:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.isViewTasksDialogVisible=!0,t.$store.commit("schedule/SET_SCHEDULE_FORM",e),setTimeout((function(){t.$refs["schedule-task-list"].update()}),100),t.$st.sendEv("定时任务","查看任务列表");case 4:case"end":return n.stop()}}),n)})))()},onRun:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.crawlConfirmDialogVisible=!0,t.$store.commit("schedule/SET_SCHEDULE_FORM",e),t.$st.sendEv("定时任务","点击运行任务");case 3:case"end":return n.stop()}}),n)})))()},onBatchAddClose:function(){this.batchAddDialogVisible=!1},onBatchAddConfirm:function(){var e=this;setTimeout((function(){e.$store.dispatch("schedule/getScheduleList")}),1e3)},onScheduleSelect:function(e){this.selectedSchedules=e}}},z=O,I=(n("0ceb"),Object(v["a"])(z,i,a,!1,null,"24e5f82a",null));t["default"]=I.exports},ce14:function(e,t,n){}}]);