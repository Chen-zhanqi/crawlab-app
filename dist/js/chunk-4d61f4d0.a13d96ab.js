(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4d61f4d0"],{"278d":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("v-tour",{attrs:{name:"setting",steps:e.tourSteps,callbacks:e.tourCallbacks,options:e.$utils.tour.getOptions(!0)}}),a("el-dialog",{attrs:{title:e.$t("Add Global Variable"),visible:e.addDialogVisible},on:{"update:visible":function(t){e.addDialogVisible=t}}},[a("el-form",{ref:"globalVariableForm",attrs:{"label-width":"80px"}},[a("el-form-item",{attrs:{label:e.$t("Key")}},[a("el-input",{attrs:{size:"small"},model:{value:e.globalVariableForm.key,callback:function(t){e.$set(e.globalVariableForm,"key",t)},expression:"globalVariableForm.key"}})],1),a("el-form-item",{attrs:{label:e.$t("Value")}},[a("el-input",{attrs:{size:"small"},model:{value:e.globalVariableForm.value,callback:function(t){e.$set(e.globalVariableForm,"value",t)},expression:"globalVariableForm.value"}})],1),a("el-form-item",{attrs:{label:e.$t("Remark")}},[a("el-input",{attrs:{size:"small"},model:{value:e.globalVariableForm.remark,callback:function(t){e.$set(e.globalVariableForm,"remark",t)},expression:"globalVariableForm.remark"}})],1),a("el-form-item",[a("div",{staticStyle:{"text-align":"right"}},[a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(t){e.addDialogVisible=!1}}},[e._v(e._s(e.$t("Cancel")))]),a("el-button",{attrs:{type:"success",size:"small"},on:{click:function(t){return e.addGlobalVariableHandle(!1)}}},[e._v(e._s(e.$t("Save")))])],1)])],1)],1),a("el-dialog",{attrs:{title:e.$t("Data Source"),visible:e.isAddDataSourceVisible},on:{"update:visible":function(t){e.isAddDataSourceVisible=t}}},[a("el-form",{ref:"dataSourceForm",attrs:{"label-width":"120px",model:e.dataSourceForm}},[a("el-form-item",{attrs:{label:e.$t("Type"),required:""}},[a("el-select",{attrs:{size:"small",prop:"type",placeholder:e.$t("Data Source Type")},model:{value:e.dataSourceForm.type,callback:function(t){e.$set(e.dataSourceForm,"type",t)},expression:"dataSourceForm.type"}},[a("el-option",{attrs:{value:"mongo",label:"MongoDB"}}),a("el-option",{attrs:{value:"mysql",label:"MySQL"}}),a("el-option",{attrs:{value:"postgres",label:"Postgres"}}),a("el-option",{attrs:{value:"kafka",label:"Kafka"}}),a("el-option",{attrs:{value:"es",label:"ElasticSearch"}})],1)],1),a("el-form-item",{attrs:{prop:"host",label:e.$t("Host"),required:""}},[a("el-input",{attrs:{size:"small",placeholder:e.$t("Host address, e.g. 192.168.0.1")},model:{value:e.dataSourceForm.host,callback:function(t){e.$set(e.dataSourceForm,"host",t)},expression:"dataSourceForm.host"}})],1),a("el-form-item",{attrs:{prop:"port",label:e.$t("Port"),required:""}},[a("el-input",{attrs:{type:"number",size:"small",placeholder:e.$t("Port, e.g. 27017")},model:{value:e.dataSourceForm.port,callback:function(t){e.$set(e.dataSourceForm,"port",t)},expression:"dataSourceForm.port"}})],1),a("el-form-item",{attrs:{prop:"database",label:e.databaseLabel,required:""}},[a("el-input",{attrs:{size:"small",placeholder:e.$t("Database")},model:{value:e.dataSourceForm.database,callback:function(t){e.$set(e.dataSourceForm,"database",t)},expression:"dataSourceForm.database"}})],1),a("el-form-item",{attrs:{prop:"username",label:e.$t("Username")}},[a("el-input",{attrs:{size:"small",placeholder:e.$t("Username")},model:{value:e.dataSourceForm.username,callback:function(t){e.$set(e.dataSourceForm,"username",t)},expression:"dataSourceForm.username"}})],1),a("el-form-item",{attrs:{prop:"password",label:e.$t("Password")}},[a("el-input",{attrs:{type:"password",size:"small",placeholder:e.$t("Password")},model:{value:e.dataSourceForm.password,callback:function(t){e.$set(e.dataSourceForm,"password",t)},expression:"dataSourceForm.password"}})],1),"mongo"===e.dataSourceForm.type?a("el-form-item",{attrs:{prop:"auth_source",label:e.$t("Auth Source")}},[a("el-input",{attrs:{size:"small",placeholder:e.$t("Auth Source (Default: admin)")},model:{value:e.dataSourceForm.auth_source,callback:function(t){e.$set(e.dataSourceForm,"auth_source",t)},expression:"dataSourceForm.auth_source"}})],1):e._e(),a("el-form-item",[a("div",{staticStyle:{"text-align":"right"}},[a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(t){e.isAddDataSourceVisible=!1}}},[e._v(e._s(e.$t("Cancel")))]),a("el-button",{attrs:{type:"success",size:"small"},on:{click:e.onConfirmAddDataSource}},[e._v(e._s(e.$t("Save")))])],1)])],1)],1),a("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":e.tabActiveHandle},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:e.$t("General"),name:"general"}},[a("el-form",{ref:"setting-form",staticClass:"setting-form",attrs:{model:e.userInfo,"label-width":"200px",rules:e.rulesNotification,"inline-message":""}},[a("el-form-item",{attrs:{prop:"username",label:e.$t("Username")}},[a("el-input",{attrs:{disabled:""},model:{value:e.userInfo.username,callback:function(t){e.$set(e.userInfo,"username",t)},expression:"userInfo.username"}})],1),a("el-form-item",{attrs:{label:e.$t("Allow Sending Statistics")}},[a("el-switch",{attrs:{"active-color":"#67C23A","inactive-color":"#909399"},on:{change:e.onAllowSendingStatisticsChange},model:{value:e.isAllowSendingStatistics,callback:function(t){e.isAllowSendingStatistics=t},expression:"isAllowSendingStatistics"}})],1),a("el-form-item",{attrs:{label:e.$t("Enable Tutorial")}},[a("el-switch",{attrs:{"active-color":"#67C23A","inactive-color":"#909399"},on:{change:e.onEnableTutorialChange},model:{value:e.isEnableTutorial,callback:function(t){e.isEnableTutorial=t},expression:"isEnableTutorial"}})],1),a("el-form-item",[a("div",{staticStyle:{"text-align":"right"}},[a("el-button",{attrs:{type:"success",size:"small"},on:{click:e.saveUserInfo}},[e._v(" "+e._s(e.$t("Save"))+" ")])],1)])],1)],1),a("el-tab-pane",{attrs:{label:e.$t("Change Password"),name:"change-password"}},[a("el-form",{ref:"change-password-form",staticClass:"change-password-form",attrs:{model:e.userInfo,"label-width":"200px","inline-message":""}},[a("el-form-item",{attrs:{prop:"password",label:e.$t("Password"),required:""}},[a("el-input",{attrs:{type:"password",placeholder:e.$t("Password")},model:{value:e.userInfo.password,callback:function(t){e.$set(e.userInfo,"password",t)},expression:"userInfo.password"}})],1),a("el-form-item",{attrs:{prop:"confirm_password",label:e.$t("Confirm Password"),required:""}},[a("el-input",{attrs:{type:"password",placeholder:e.$t("Confirm Password")},model:{value:e.userInfo.confirm_password,callback:function(t){e.$set(e.userInfo,"confirm_password",t)},expression:"userInfo.confirm_password"}})],1),a("el-form-item",[a("div",{staticStyle:{"text-align":"right"}},[a("el-button",{attrs:{type:"success",size:"small"},on:{click:e.changePassword}},[e._v(" "+e._s(e.$t("Save"))+" ")])],1)])],1)],1),a("el-tab-pane",{attrs:{label:e.$t("Notifications"),name:"notify"}},[a("el-form",{ref:"setting-form",staticClass:"setting-form",attrs:{model:e.userInfo,"label-width":"200px",rules:e.rulesNotification,"inline-message":""}},[a("el-form-item",{attrs:{label:e.$t("Notification Trigger Timing")}},[a("el-radio-group",{model:{value:e.userInfo.setting.notification_trigger,callback:function(t){e.$set(e.userInfo.setting,"notification_trigger",t)},expression:"userInfo.setting.notification_trigger"}},[a("el-radio",{attrs:{label:"notification_trigger_on_task_end"}},[e._v(" "+e._s(e.$t("On Task End"))+" ")]),a("el-radio",{attrs:{label:"notification_trigger_on_task_error"}},[e._v(" "+e._s(e.$t("On Task Error"))+" ")]),a("el-radio",{attrs:{label:"notification_trigger_never"}},[e._v(" "+e._s(e.$t("Never"))+" ")])],1)],1),a("el-form-item",{attrs:{prop:"enabledNotifications",label:e.$t("消息通知方式")}},[a("el-checkbox-group",{model:{value:e.userInfo.setting.enabled_notifications,callback:function(t){e.$set(e.userInfo.setting,"enabled_notifications",t)},expression:"userInfo.setting.enabled_notifications"}},[a("el-checkbox",{attrs:{label:"notification_type_mail"}},[e._v(e._s(e.$t("邮件")))]),a("el-checkbox",{attrs:{label:"notification_type_ding_talk"}},[e._v(e._s(e.$t("钉钉")))]),a("el-checkbox",{attrs:{label:"notification_type_wechat"}},[e._v(e._s(e.$t("企业微信")))])],1)],1),a("el-form-item",{attrs:{prop:"email",label:e.$t("Email")}},[a("el-input",{attrs:{placeholder:e.$t("Email")},model:{value:e.userInfo.email,callback:function(t){e.$set(e.userInfo,"email",t)},expression:"userInfo.email"}})],1),a("el-form-item",{attrs:{prop:"setting.ding_talk_robot_webhook",label:e.$t("DingTalk Robot Webhook")}},[a("el-input",{attrs:{placeholder:e.$t("DingTalk Robot Webhook")},model:{value:e.userInfo.setting.ding_talk_robot_webhook,callback:function(t){e.$set(e.userInfo.setting,"ding_talk_robot_webhook",t)},expression:"userInfo.setting.ding_talk_robot_webhook"}})],1),a("el-form-item",{attrs:{prop:"setting.wechat_robot_webhook",label:e.$t("Wechat Robot Webhook")}},[a("el-input",{attrs:{placeholder:e.$t("Wechat Robot Webhook")},model:{value:e.userInfo.setting.wechat_robot_webhook,callback:function(t){e.$set(e.userInfo.setting,"wechat_robot_webhook",t)},expression:"userInfo.setting.wechat_robot_webhook"}})],1),a("el-form-item",[a("div",{staticStyle:{"text-align":"right"}},[a("el-button",{attrs:{type:"success",size:"small"},on:{click:e.saveUserInfo}},[e._v(" "+e._s(e.$t("Save"))+" ")])],1)])],1)],1),a("el-tab-pane",{attrs:{label:e.$t("Log"),name:"log"}},[a("el-form",{ref:"log-form",staticClass:"setting-form",attrs:{model:e.userInfo,"label-width":"200px",rules:e.rulesLog,"inline-message":""}},[a("el-form-item",{attrs:{label:e.$t("Error Regex Pattern"),prop:"setting.error_regex_pattern"}},[a("el-input",{attrs:{placeholder:e.$t("By default: ")+e.$utils.log.errorRegex.source,clearable:""},model:{value:e.userInfo.setting.error_regex_pattern,callback:function(t){e.$set(e.userInfo.setting,"error_regex_pattern",t)},expression:"userInfo.setting.error_regex_pattern"}})],1),a("el-form-item",{attrs:{label:e.$t("Max Error Logs Display"),prop:"setting.max_error_log"}},[a("el-select",{attrs:{clearable:""},model:{value:e.userInfo.setting.max_error_log,callback:function(t){e.$set(e.userInfo.setting,"max_error_log",t)},expression:"userInfo.setting.max_error_log"}},[a("el-option",{attrs:{value:100,label:"100"}}),a("el-option",{attrs:{value:500,label:"500"}}),a("el-option",{attrs:{value:1e3,label:"1000"}}),a("el-option",{attrs:{value:5e3,label:"5000"}}),a("el-option",{attrs:{value:1e4,label:"10000"}})],1)],1),a("el-form-item",{attrs:{label:e.$t("Log Expire Duration"),prop:"setting.log_expire_duration"}},[a("el-select",{attrs:{clearable:""},model:{value:e.userInfo.setting.log_expire_duration,callback:function(t){e.$set(e.userInfo.setting,"log_expire_duration",t)},expression:"userInfo.setting.log_expire_duration"}},[a("el-option",{attrs:{value:99999999,label:e.$t("No Expire")}}),a("el-option",{attrs:{value:3600,label:"1 "+e.$t("Hour")}}),a("el-option",{attrs:{value:21600,label:"6 "+e.$t("Hours")}}),a("el-option",{attrs:{value:43200,label:"12 "+e.$t("Hours")}}),a("el-option",{attrs:{value:86400,label:"1 "+e.$t("Day")}}),a("el-option",{attrs:{value:604800,label:"7 "+e.$t("Days")}}),a("el-option",{attrs:{value:1209600,label:"14 "+e.$t("Days")}}),a("el-option",{attrs:{value:2592e3,label:"30 "+e.$t("Days")}}),a("el-option",{attrs:{value:7776e3,label:"90 "+e.$t("Days")}}),a("el-option",{attrs:{value:15552e3,label:"180 "+e.$t("Days")}})],1)],1),a("el-form-item",[a("div",{staticStyle:{"text-align":"right"}},[a("el-button",{attrs:{type:"success",size:"small"},on:{click:e.saveUserInfo}},[e._v(" "+e._s(e.$t("Save"))+" ")])],1)])],1)],1),a("el-tab-pane",{attrs:{label:"API Token",name:"api-token"}},[a("input",{attrs:{id:"clipboard"}}),a("el-alert",{attrs:{type:"primary"}}),a("div",{staticClass:"actions"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.onAddApiToken}},[e._v(" "+e._s(e.$t("Add"))+" ")])],1),a("el-table",{attrs:{data:e.apiTokens,border:""}},[a("el-table-column",{attrs:{label:"Token"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.visible?t.row.token:e.getMaskValue(t.row.token))+" ")]}}])}),a("el-table-column",{attrs:{label:e.$t("Action"),width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"warning",size:"mini",icon:"el-icon-view",circle:""},on:{click:function(a){return e.toggleTokenVisible(t.row)}}}),a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-document-copy",circle:""},on:{click:function(a){return e.copyToken(t.row.token)}}}),a("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete",circle:""},on:{click:function(a){return e.onDeleteToken(t.row)}}})]}}])})],1)],1),a("el-tab-pane",{attrs:{label:e.$t("Global Variable"),name:"global-variable"}},[a("div",{staticStyle:{"text-align":"right","margin-bottom":"10px"}},[a("el-button",{attrs:{size:"small",icon:"el-icon-plus",type:"primary"},on:{click:function(t){return e.addGlobalVariableHandle(!0)}}},[e._v(" "+e._s(e.$t("Add"))+" ")]),a("el-button",{attrs:{size:"small",type:"success"},on:{click:e.saveUserInfo}},[e._v(e._s(e.$t("Save")))])],1),a("el-table",{attrs:{data:e.globalVariableList,border:""}},[a("el-table-column",{attrs:{prop:"key",label:e.$t("Key")}}),a("el-table-column",{attrs:{prop:"value",label:e.$t("Value")}}),a("el-table-column",{attrs:{prop:"remark",label:e.$t("Remark")}}),a("el-table-column",{attrs:{prop:"",label:e.$t("Action"),width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{icon:"el-icon-delete",type:"danger",size:"mini"},on:{click:function(a){return e.deleteGlobalVariableHandle(t.row._id)}}})]}}])})],1)],1),a("el-tab-pane",{attrs:{label:e.$t("Data Source"),name:"data-source"}},[a("div",{staticStyle:{"text-align":"right","margin-bottom":"10px"}},[a("el-button",{attrs:{size:"small",icon:"el-icon-plus",type:"primary"},on:{click:e.onClickAddDataSource}},[e._v(" "+e._s(e.$t("Add"))+" ")]),a("el-button",{attrs:{size:"small",type:"success"},on:{click:e.saveUserInfo}},[e._v(e._s(e.$t("Save")))])],1),a("el-table",{attrs:{data:e.dataSourceList,border:""}},[a("el-table-column",{attrs:{prop:"type",label:e.$t("Type")}}),a("el-table-column",{attrs:{prop:"host",label:e.$t("Host")}}),a("el-table-column",{attrs:{prop:"port",label:e.$t("Port")}}),a("el-table-column",{attrs:{prop:"database",label:e.$t("Database")+" / Topic / Index"}}),a("el-table-column",{attrs:{prop:"username",label:e.$t("Username")}}),a("el-table-column",{attrs:{prop:"password",label:e.$t("Password")},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.getMaskValue(t.row.password))+" ")]}}])}),a("el-table-column",{attrs:{prop:"auth_source",label:e.$t("Auth Source")}}),a("el-table-column",{attrs:{label:e.$t("Action"),width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"warning",size:"mini",icon:"el-icon-edit",circle:""},on:{click:function(a){return e.onClickEditDataSource(t.row)}}}),a("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete",circle:""},on:{click:function(a){return e.onDeleteDataSource(t.row)}}})]}}])})],1)],1)],1)],1)},o=[],s=(a("e35a"),a("f4e3"),a("6a61"),a("cf7f")),n=a("e793"),l=a("9f3a"),i={name:"Setting",data:function(){var e=this,t=function(t,a,r){if(!a)return r();a.length<5?r(new Error(e.$t("Password length should be no shorter than 5"))):r()},a=function(t,a,r){if(!a)return r();a.match(/.+@.+/i)?r():r(new Error(e.$t("Email format invalid")))},r=function(t,a,r){if(!a)return r();a.match(/^https:\/\/oapi.dingtalk.com\/robot\/send\?access_token=[a-f0-9]+/i)?r():r(new Error(e.$t("DingTalk Robot Webhook format invalid")))},o=function(t,a,r){if(!a)return r();a.match(/^https:\/\/qyapi.weixin.qq.com\/cgi-bin\/webhook\/send\?key=.+/i)?r():r(new Error(e.$t("DingTalk Robot Webhook format invalid")))};return{userInfo:{setting:{enabled_notifications:[]}},rulesNotification:{password:[{trigger:"blur",validator:t}],email:[{trigger:"blur",validator:a}],"setting.ding_talk_robot_webhook":[{trigger:"blur",validator:r}],"setting.wechat_robot_webhook":[{trigger:"blur",validator:o}]},rulesLog:{},isShowDingTalkAppSecret:!1,activeName:"general",addDialogVisible:!1,tourSteps:[{target:"#tab-general",content:this.$t("Here you can set your general settings."),params:{placement:"right"}},{target:"#tab-notify",content:this.$t("In this tab you can configure your notification settings.")},{target:"#tab-global-variable",content:this.$t("Here you can add/edit/delete global environment variables which will be passed into your spider programs.")}],tourCallbacks:{onStop:function(){e.$utils.tour.finishTour("setting")},onPreviousStep:function(t){1===t?e.activeName="password":2===t&&(e.activeName="notify"),e.$utils.tour.prevStep("setting",t)},onNextStep:function(t){0===t?e.activeName="notify":1===t&&(e.activeName="global-variable"),e.$utils.tour.nextStep("setting",t)}},isAllowSendingStatistics:"1"===localStorage.getItem("useStats"),isEnableTutorial:"1"===localStorage.getItem("enableTutorial"),apiTokens:[],dataSources:[],dataSourceForm:{},isAddDataSourceVisible:!1}},computed:Object(n["a"])(Object(n["a"])(Object(n["a"])({},Object(l["c"])("user",["globalVariableList","globalVariableForm"])),Object(l["c"])("dataSource",["dataSourceList"])),{},{databaseLabel:function(){return"kafka"===this.dataSourceForm.type?"Topic":"es"===this.dataSourceForm.type?"Index":this.$t("Database")}}),watch:{userInfoStr:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.saveUserInfo();case 2:return t.next=4,e.$store.dispatch("user/getInfo");case 4:case"end":return t.stop()}}),t)})))()}},created:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("user/getInfo");case 2:return t.next=4,e.$store.dispatch("user/getGlobalVariable");case 4:return e.getUserInfo(),t.next=7,e.getApiTokens();case 7:return t.next=9,e.getDataSources();case 9:case"end":return t.stop()}}),t)})))()},mounted:function(){this.$utils.tour.isFinishedTour("setting")||this.$utils.tour.startTour(this,"setting")},methods:{deleteGlobalVariableHandle:function(e){var t=this;this.$confirm(this.$t("Are you sure to delete this global variable"),this.$t("Notification"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning"}).then((function(){t.$store.dispatch("user/deleteGlobalVariable",e).then((function(){t.$store.dispatch("user/getGlobalVariable")}))}))["catch"]((function(){}))},addGlobalVariableHandle:function(e){var t=this;e?this.addDialogVisible=!0:this.$store.dispatch("user/addGlobalVariable").then((function(){t.addDialogVisible=!1,t.$st.sendEv("设置","添加全局变量")})).then((function(){t.$store.dispatch("user/getGlobalVariable")}))},getUserInfo:function(){var e=localStorage.getItem("user_info");if(!e)return{};this.userInfo=JSON.parse(e),this.userInfo.setting||(this.userInfo.setting={}),this.userInfo.setting.enabled_notifications||(this.userInfo.setting.enabled_notifications=[])},saveUserInfo:function(){var e=this;this.$refs["setting-form"].validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(a){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.$store.dispatch("user/postInfo",e.userInfo);case 4:r=t.sent,r.data.error||e.$message.success(e.$t("Saved successfully"));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),this.$st.sendEv("设置","保存")},tabActiveHandle:function(){},onAllowSendingStatisticsChange:function(e){e?(this.$st.sendPv("/allow_stats"),this.$st.sendEv("全局","允许/禁止统计","允许")):(this.$st.sendPv("/disallow_stats"),this.$st.sendEv("全局","允许/禁止统计","禁止")),this.$message.success(this.$t("Saved successfully")),localStorage.setItem("useStats",e?"1":"0")},onEnableTutorialChange:function(e){this.$message.success(this.$t("Saved successfully")),localStorage.setItem("enableTutorial",e?"1":"0")},onAddApiToken:function(){var e=this;this.$confirm(this.$t("Are you sure to add an API token?"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$request.put("/tokens");case 2:if(a=t.sent,a.data.error){t.next=7;break}return e.$message.success(e.$t("Added API token successfully")),t.next=7,e.getApiTokens();case 7:case"end":return t.stop()}}),t)}))))},onDeleteToken:function(e){var t=this;this.$confirm(this.$t("Are you sure to delete this API token?"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function a(){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$request["delete"]("/tokens/".concat(e._id));case 2:if(r=a.sent,r.data.error){a.next=7;break}return t.$message.success(t.$t("Deleted API token successfully")),a.next=7,t.getApiTokens();case 7:case"end":return a.stop()}}),a)}))))},addApiToken:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$request.put("/tokens");case 2:case"end":return t.stop()}}),t)})))()},getApiTokens:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$request.get("/tokens");case 2:a=t.sent,e.apiTokens=a.data.data;case 4:case"end":return t.stop()}}),t)})))()},toggleTokenVisible:function(e){this.$set(e,"visible",!e.visible)},getDataSources:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("dataSource/getDataSourceList");case 2:case"end":return t.stop()}}),t)})))()},onClickAddDataSource:function(){this.dataSourceForm={type:"mongo"},this.isAddDataSourceVisible=!0},onClickEditDataSource:function(e){this.dataSourceForm=e,this.isAddDataSourceVisible=!0},onConfirmAddDataSource:function(){var e=this;this.$refs["dataSourceForm"].validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(a){var r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a){t.next=2;break}return t.abrupt("return");case 2:if(!e.dataSourceForm._id){t.next=9;break}return t.next=5,e.$request.post("/datasources/".concat(e.dataSourceForm._id),e.dataSourceForm);case 5:r=t.sent,!r||r.data.error?e.$message.error(e.$t("Change data source failed")):e.$message.success(e.$t("Changed data source successfully")),t.next=13;break;case 9:return t.next=11,e.$request.put("/datasources",e.dataSourceForm);case 11:o=t.sent,!o||o.data.error?e.$message.error(e.$t("Add data source failed")):e.$message.success(e.$t("Added data source successfully"));case 13:return e.isAddDataSourceVisible=!1,t.next=16,e.getDataSources();case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},onDeleteDataSource:function(e){var t=this;this.$confirm(this.$t("Are you sure to delete this data source?"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function a(){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$request["delete"]("/datasources/".concat(e._id));case 2:if(r=a.sent,r.data.error){a.next=7;break}return t.$message.success(t.$t("Deleted data source successfully")),a.next=7,t.getDataSources();case 7:case"end":return a.stop()}}),a)}))))},getMaskValue:function(e){for(var t="",a=0;a<e.length;a++)t+="*";return t},copyToken:function(e){var t=document.getElementById("clipboard");t.value=e,t.select(),document.execCommand("copy"),this.$message.success(this.$t("Token copied"))},changePassword:function(){var e=this;this.$refs["change-password-form"].validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(a){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a){t.next=2;break}return t.abrupt("return");case 2:if(e.userInfo.password===e.userInfo.confirm_password){t.next=5;break}return e.$message.error(e.$t("Two passwords do not match")),t.abrupt("return");case 5:if(!(e.userInfo.password.length<5)){t.next=8;break}return e.$message.error(e.$t("Password length should be no shorter than 5")),t.abrupt("return");case 8:return t.next=10,e.$request.post("/me/change-password",{password:e.userInfo.password});case 10:r=t.sent,r.data.error||e.$message.success(e.$t("Changed password successfully"));case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}},c=i,u=(a("419d"),a("9ca4")),d=Object(u["a"])(c,r,o,!1,null,"5998fb82",null);t["default"]=d.exports},"419d":function(e,t,a){"use strict";var r=a("b4b8"),o=a.n(r);o.a},b4b8:function(e,t,a){}}]);