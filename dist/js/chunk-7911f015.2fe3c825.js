(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7911f015"],{"6f40":function(t,e,s){},b3d7:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app-container"},[s("el-row",[s("ul",{staticClass:"metric-list"},t._l(t.metrics,(function(e){return s("li",{key:e.name,staticClass:"metric-item",on:{click:function(s){return t.onClickMetric(e)}}},[s("div",{staticClass:"metric-icon",class:e.color},[s("i",{class:e.icon})]),s("div",{staticClass:"metric-content",class:e.color},[s("div",{staticClass:"metric-wrapper"},[s("div",{staticClass:"metric-number"},[t._v(" "+t._s(t.overviewStats[e.name])+" ")]),s("div",{staticClass:"metric-name"},[t._v(" "+t._s(t.$t(e.label))+" ")])])])])})),0)]),s("el-row",[s("ul",{staticClass:"performance-metric-list"},[s("li",{staticClass:"performance-metric-item mongo"},[s("div",{staticClass:"performance-metric-title"},[s("i",{staticClass:"fa fa-database"}),t._v(" MongoDB ")]),s("div",{staticClass:"performance-metric-body"},[s("div",{staticClass:"progress-item"},[s("span",{staticClass:"progress-label"},[t._v(" "+t._s(t.$t("Disk"))+" ")]),s("el-progress",{attrs:{"stroke-width":18,percentage:t.mongoDiskPercent,"text-inside":"",status:t.getProgressStatus(t.mongoDiskPercent)}})],1),s("div",{staticClass:"progress-item"},[s("span",{staticClass:"progress-label"},[t._v(" "+t._s(t.$t("Memory"))+" ")]),s("el-progress",{attrs:{"stroke-width":18,percentage:t.mongoMemoryPercent,"text-inside":"",status:t.getProgressStatus(t.mongoMemoryPercent)}})],1),s("div",{staticClass:"progress-item"},[s("span",{staticClass:"progress-label"},[t._v(" "+t._s(t.$t("Data Size"))+" ")]),s("el-tag",{attrs:{"text-inside":"",size:"small",type:"primary"}},[t._v(" "+t._s(t.mongoDataSize)+" GB ")])],1),s("div",{staticClass:"progress-item"},[s("span",{staticClass:"progress-label"},[t._v(" "+t._s(t.$t("Storage Size"))+" ")]),s("el-tag",{attrs:{"text-inside":"",size:"small",type:"primary"}},[t._v(" "+t._s(t.mongoStorageSize)+" GB ")])],1),s("div",{staticClass:"progress-item"},[s("span",{staticClass:"progress-label"},[t._v(" "+t._s(t.$t("Index Size"))+" ")]),s("el-tag",{attrs:{"text-inside":"",size:"small",type:"primary"}},[t._v(" "+t._s(t.mongoIndexSize)+" GB ")])],1)])]),s("li",{staticClass:"performance-metric-item redis"},[s("div",{staticClass:"performance-metric-title"},[s("i",{staticClass:"fa fa-database"}),t._v(" Redis ")]),s("div",{staticClass:"performance-metric-body"},[s("div",{staticClass:"progress-item"},[s("span",{staticClass:"progress-label"},[t._v(" "+t._s(t.$t("Total Allocated"))+" ")]),s("el-tag",{attrs:{"text-inside":"",size:"small",type:"primary"}},[t._v(" "+t._s(t.redisTotalAllocated)+" MB ")])],1),s("div",{staticClass:"progress-item"},[s("span",{staticClass:"progress-label"},[t._v(" "+t._s(t.$t("Peak Allocated"))+" ")]),s("el-tag",{attrs:{"text-inside":"",size:"small",type:"primary"}},[t._v(" "+t._s(t.redisPeakAllocated)+" MB ")])],1),s("div",{staticClass:"progress-item"},[s("span",{staticClass:"progress-label"},[t._v(" "+t._s(t.$t("Dataset Size"))+" ")]),s("el-tag",{attrs:{"text-inside":"",size:"small",type:"primary"}},[t._v(" "+t._s(t.redisDataset)+" MB ")])],1),s("div",{staticClass:"progress-item"},[s("span",{staticClass:"progress-label"},[t._v(" "+t._s(t.$t("Overhead Size"))+" ")]),s("el-tag",{attrs:{"text-inside":"",size:"small",type:"primary"}},[t._v(" "+t._s(t.redisOverhead)+" MB ")])],1)])]),t._l(t.nodeList,(function(e){return s("li",{key:e._id,staticClass:"performance-metric-item node",class:e.is_master?"master":"worker"},[s("div",{staticClass:"performance-metric-title"},[s("i",{staticClass:"fa fa-server"}),t._v(" "+t._s(e.name)+t._s(e.is_master?" ("+t.$t("Master")+")":"")+" ")]),s("div",{staticClass:"performance-metric-body"},[s("div",{staticClass:"progress-item"},[s("span",{staticClass:"progress-label"},[t._v(" "+t._s(t.$t("Disk"))+" ")]),s("el-progress",{attrs:{"stroke-width":18,percentage:t.getNodeStatsValue(e,"disk_usage_percent"),"text-inside":"",status:t.getProgressStatus(t.getNodeStatsValue(e,"disk_usage_percent"))}})],1),s("div",{staticClass:"progress-item"},[s("span",{staticClass:"progress-label"},[t._v(" "+t._s(t.$t("Memory"))+" ")]),s("el-progress",{attrs:{"stroke-width":18,percentage:t.getNodeStatsValue(e,"memory_usage_percent"),"text-inside":"",status:t.getProgressStatus(t.getNodeStatsValue(e,"memory_usage_percent"))}})],1),s("div",{staticClass:"progress-item"},[s("span",{staticClass:"progress-label"},[t._v(" "+t._s(t.$t("CPU"))+" ")]),s("el-progress",{attrs:{"stroke-width":18,percentage:t.getNodeStatsValue(e,"cpu_usage_percent"),"text-inside":"",status:t.getProgressStatus(t.getNodeStatsValue(e,"cpu_usage_percent"))}})],1),s("div",{staticClass:"progress-item"},[s("span",{staticClass:"progress-label"},[t._v(" "+t._s(t.$t("Disk Usage"))+" ")]),s("el-tag",{attrs:{"text-inside":"",size:"small",type:"primary"}},[t._v(" "+t._s(t.getSize(t.getNodeStatsValue(e,"disk_usage")))+" GB / "+t._s(t.getSize(t.getNodeStatsValue(e,"disk_total")))+" GB ")])],1),s("div",{staticClass:"progress-item"},[s("span",{staticClass:"progress-label"},[t._v(" "+t._s(t.$t("Memory Usage"))+" ")]),s("el-tag",{attrs:{"text-inside":"",size:"small",type:"primary"}},[t._v(" "+t._s(t.getSize(t.getNodeStatsValue(e,"memory_usage")))+" GB / "+t._s(t.getSize(t.getNodeStatsValue(e,"memory_total")))+" GB ")])],1)])])}))],2)]),s("el-row",[s("el-card",{attrs:{shadow:"hover"}},[s("h4",{staticClass:"title"},[t._v(t._s(t.$t("Daily New Tasks")))]),s("div",{staticClass:"echarts-box",attrs:{id:"echarts-daily-tasks"}})])],1)],1)},r=[],i=(s("2eeb"),s("20a5"),s("e18c"),s("96db"),s("af86"),s("1fb3"),s("6a61"),s("cf7f")),n=s("e793"),o=s("9f3a"),c=s("4d28"),l=s.n(c),d={name:"Home",data:function(){return{echarts:{},overviewStats:{},dailyTasks:[],metrics:[{name:"task_count",label:"Total Tasks",icon:"fa fa-check",color:"blue",path:"tasks"},{name:"spider_count",label:"Spiders",icon:"fa fa-bug",color:"green",path:"spiders"},{name:"active_node_count",label:"Active Nodes",icon:"fa fa-server",color:"red",path:"nodes"},{name:"schedule_count",label:"Schedules",icon:"fa fa-clock-o",color:"orange",path:"schedules"},{name:"project_count",label:"Projects",icon:"fa fa-code-fork",color:"grey",path:"projects"}],mongoStats:{db_stats:{},mem_stats:{}},redisStats:{},nodeStatsDict:{},statsHandle:void 0}},computed:Object(n["a"])(Object(n["a"])({},Object(o["c"])("node",["nodeList"])),{},{mongoDiskPercent:function(){return Math.round(this.mongoStats.db_stats.fsUsedSize/this.mongoStats.db_stats.fsTotalSize*100)},mongoMemoryPercent:function(){return Math.round(this.mongoStats.mem_stats.resident/this.mongoStats.mem_stats.virtual*100)},mongoDataSize:function(){var t=this.mongoStats.db_stats.dataSize/1024/1024/1024;return t<.01?"<0.01":t.toFixed(2)},mongoStorageSize:function(){var t=this.mongoStats.db_stats.storageSize/1024/1024/1024;return t<.01?"<0.01":t.toFixed(2)},mongoIndexSize:function(){var t=this.mongoStats.db_stats.indexSize/1024/1024/1024;return t<.01?"<0.01":t.toFixed(2)},redisTotalAllocated:function(){return(this.redisStats.total_allocated/1024/1024).toFixed(2)},redisPeakAllocated:function(){return(this.redisStats.peak_allocated/1024/1024).toFixed(2)},redisDataset:function(){return(this.redisStats.dataset_bytes/1024/1024).toFixed(2)},redisOverhead:function(){return(this.redisStats.overhead_total/1024/1024).toFixed(2)}}),created:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getAllStats();case 2:t.statsHandle=setInterval((function(){t.getAllStats()}),15e3);case 3:case"end":return e.stop()}}),e)})))()},mounted:function(){},destroyed:function(){clearInterval(this.statsHandle)},methods:{initEchartsDailyTasks:function(){var t={xAxis:{type:"category",data:this.dailyTasks.map((function(t){return t.date}))},yAxis:{type:"value"},series:[{data:this.dailyTasks.map((function(t){return t.task_count})),type:"line",areaStyle:{},smooth:!0}],tooltip:{trigger:"axis",show:!0}};this.echarts.dailyTasks=l.a.init(this.$el.querySelector("#echarts-daily-tasks")),this.echarts.dailyTasks.setOption(t)},onClickMetric:function(t){this.$router.push("/".concat(t.path))},getBasicStats:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$request.get("/stats/home");case 2:s=e.sent,t.overviewStats=s.data.data.overview,t.dailyTasks=s.data.data.daily,t.initEchartsDailyTasks();case 6:case"end":return e.stop()}}),e)})))()},getMonitorStats:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getMongoStats();case 2:return e.next=4,t.getRedisStats();case 4:return e.next=6,t.getNodesStats();case 6:case"end":return e.stop()}}),e)})))()},getMongoStats:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$request.get("/monitor/mongo");case 2:s=e.sent,t.mongoStats=s.data.data;case 4:case"end":return e.stop()}}),e)})))()},getRedisStats:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$request.get("/monitor/redis");case 2:s=e.sent,t.redisStats=s.data.data;case 4:case"end":return e.stop()}}),e)})))()},getNodesStats:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("node/getNodeList");case 2:return e.next=4,Promise.all(t.nodeList.map(function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(s){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$request.get("/monitor/nodes/"+s._id);case 2:a=e.sent,t.$set(t.nodeStatsDict,s._id,a.data.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:case"end":return e.stop()}}),e)})))()},getProgressStatus:function(t){return t>=80?"exception":t>=40?"warning":"success"},getNodeStatsValue:function(t,e){return this.nodeStatsDict[t._id]?Math.round(this.nodeStatsDict[t._id][e]):0},getSize:function(t){return(t/1024/1024/1024).toFixed(2)},getAllStats:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getBasicStats();case 2:return e.next=4,t.getMonitorStats();case 4:case"end":return e.stop()}}),e)})))()}}},u=d,m=(s("e69d"),s("9ca4")),g=Object(m["a"])(u,a,r,!1,null,"a2a2cdb2",null);e["default"]=g.exports},e69d:function(t,e,s){"use strict";var a=s("6f40"),r=s.n(a);r.a}}]);